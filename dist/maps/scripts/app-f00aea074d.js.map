{"version":3,"sources":["scripts/app.js"],"names":["processImg","callback","imgSelect","$","file","files","imgReader","FileReader","readAsDataURL","console","log","onloadend","name","match","document","getElementById","innerHTML","longtextstyle","sendEmotionReq","ajax","url","beforeSend","emoteHdrs","setRequestHeader","type","data","processData","done","length","scores","fail","error","getAllResponseHeaders","sendPoemReq","currentMoodDesc","xhttp","XMLHttpRequest","onreadystatechange","this","readyState","xmlresp","responseXML","currentMoodPoem","getElementsByTagName","childNodes","nodeValue","style","fontSize","open","send","getCurrentMood","currentMoodVal","neutral","happiness","sadness","anger","contempt","disgust","fear","suprise","updateUI","angular","module","component","templateUrl","ready","addEventListener","emotionScores","run","$templateCache","put"],"mappings":"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","file":"scripts/app-f00aea074d.js","sourcesContent":["/// <reference path=\"../typings/index.d.ts\" />\nangular\n    .module('app', []);\n\n/// <reference path='../../typings/index.d.ts' />\nangular\n    .module('app')\n    .component('fountainTitle', {\n    templateUrl: 'app/title.html'\n});\nvar currentMoodVal;\nvar currentMoodDesc;\nvar currentMoodPoem;\n$(document).ready(function () {\n    document.getElementById('file-selector').addEventListener('change', function () {\n        document.getElementById('headerf').innerHTML = 'Connecting to space satellites...';\n        document.getElementById('headers').innerHTML = 'Shouldnt take too long';\n        processImg(function (file) {\n            sendEmotionReq(file, function (emotionScores) {\n                currentMoodDesc = getCurrentMood(emotionScores);\n                currentMoodPoem = sendPoemReq(currentMoodDesc);\n                updateUI();\n            });\n        });\n    });\n});\nfunction processImg(callback) {\n    var imgSelect = $('#file-selector')[0];\n    var file = imgSelect.files[0];\n    var imgReader = new FileReader();\n    if (file) {\n        imgReader.readAsDataURL(file);\n    }\n    else {\n        console.log('No good');\n    }\n    imgReader.onloadend = function () {\n        if (!file.name.match(/\\.(jpg|jpeg|png)$/)) {\n            document.getElementById('headerf').innerHTML = 'Whoops! we only accept image files here';\n            longtextstyle();\n            document.getElementById('headers').innerHTML = 'Valid file types are: jpg, jpeg & png';\n        }\n        else {\n            callback(file);\n        }\n    };\n}\nfunction sendEmotionReq(file, callback) {\n    $.ajax({\n        url: 'https://api.projectoxford.ai/emotion/v1.0/recognize',\n        beforeSend: function (emoteHdrs) {\n            emoteHdrs.setRequestHeader('Content-Type', 'application/octet-stream');\n            emoteHdrs.setRequestHeader('Ocp-Apim-Subscription-Key', 'f601d06265de4683bd55390c682a3916');\n        },\n        type: 'POST',\n        data: file,\n        processData: false\n    })\n        .done(function (data) {\n        if (data.length === 0) {\n            document.getElementById('headerf').innerHTML = 'We couldnt find any faces in that photo :(';\n            document.getElementById('headers').innerHTML = 'Try again with a different photo?';\n            longtextstyle();\n        }\n        else {\n            var scores = data[0].scores;\n            callback(scores);\n        }\n    })\n        .fail(function (error) {\n        document.getElementById('headerf').innerHTML = 'Oh no, something went wrong on our end!';\n        document.getElementById('headers').innerHTML = 'Give it another try soon :)';\n        longtextstyle();\n        console.log(error.getAllResponseHeaders());\n    });\n}\nfunction sendPoemReq(currentMoodDesc) {\n    var xhttp = new XMLHttpRequest();\n    xhttp.onreadystatechange = function () {\n        if (this.readyState === 4) {\n            var xmlresp = this.responseXML;\n            currentMoodPoem = xmlresp.getElementsByTagName('poem')[0].childNodes[0].nodeValue;\n            document.getElementById('headers').innerHTML = currentMoodPoem;\n            document.getElementById('headers').style.fontSize = '2rem';\n        }\n    };\n    xhttp.open('GET', 'http://www.stands4.com/services/v2/poetry.php?uid=5341&tokenid=exMiPJwO89aeOkfk&term=' + currentMoodDesc, true);\n    xhttp.send();\n}\nfunction getCurrentMood(scores) {\n    currentMoodVal = scores.neutral;\n    currentMoodDesc = 'neutral';\n    if (scores.happiness > currentMoodVal) {\n        currentMoodVal = scores.happiness;\n        currentMoodDesc = 'happiness';\n    }\n    else if (scores.sadness > currentMoodVal) {\n        currentMoodVal = scores.sadness;\n        currentMoodDesc = 'sad';\n    }\n    else if (scores.anger > currentMoodVal) {\n        currentMoodVal = scores.anger;\n        currentMoodDesc = 'angry';\n    }\n    else if (scores.contempt < currentMoodVal) {\n        currentMoodVal = scores.contempt;\n        currentMoodDesc = 'contempt';\n    }\n    else if (scores.disgust < currentMoodVal) {\n        currentMoodVal = scores.disgust;\n        currentMoodDesc = 'disgusted';\n    }\n    else if (scores.fear < currentMoodVal) {\n        currentMoodVal = scores.fear;\n        currentMoodDesc = 'scared';\n    }\n    else if (scores.suprise < currentMoodVal) {\n        currentMoodVal = scores.suprise;\n        currentMoodDesc = 'suprised';\n    }\n    return currentMoodDesc;\n}\nfunction longtextstyle() {\n    document.getElementById('headerf').style.fontSize = '4rem';\n    document.getElementById('headers').style.fontSize = '3rem';\n}\nfunction updateUI() {\n    document.getElementById('headerf').innerHTML = 'We have detected you are feeling: ' + currentMoodDesc;\n    document.getElementById('headerf').style.fontSize = '4rem';\n}\n\n/// <reference path=\"../../typings/index.d.ts\" />\nangular\n    .module('app')\n    .component('app', {\n    templateUrl: 'app/main.html'\n});\n\n/// <reference path=\"../../typings/index.d.ts\" />\nangular\n    .module('app')\n    .component('fountainHeader', {\n    templateUrl: 'app/header.html'\n});\n\n/// <reference path=\"../../typings/index.d.ts\" />\nangular\n    .module('app')\n    .component('fountainFooter', {\n    templateUrl: 'app/footer.html'\n});\n\nangular.module(\"app\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/footer.html\",\"<footer class=\\\"footer\\\">\\n  Built with â™¥ by Kendall Lynch\\n  \\n</footer>\\n\");\n$templateCache.put(\"app/header.html\",\"<header class=\\\"header\\\">\\n  <p class=\\\"header-title\\\">\\n      mePoem\\n    \\n  </p>\\n  <p class=\\\"header-desc\\\">\\n    Generate high quality poems based on your mood!\\n  </p>\\n</header>\");\n$templateCache.put(\"app/main.html\",\"<div class=\\\"main-container\\\">\\n  <fountain-header></fountain-header>\\n  <main class=\\\"main\\\">\\n    <fountain-title></fountain-title>\\n  </main>\\n  <div id=\\\"footer\\\">\\n  <fountain-footer></fountain-footer>\\n</div>\\n</div>\\n\");\n$templateCache.put(\"app/title.html\",\"<div class=\\\"title\\\">\\n  <h1 id=\\\"headerf\\\" class=\\\"title-h1\\\">Welcome!</h1>\\n  <div class=\\\"btn-wrapper\\\">\\n    <label class=\\\"btn btn-info\\\" for=\\\"file-selector\\\">\\n      <input id=\\\"file-selector\\\" type=\\\"file\\\">\\n      </label>\\n      </div>\\n  <h2 id=\\\"headers\\\" class=\\\"title-h2\\\">Please upload a photo to begin.</h2>\\n</div>\\n\");}]);"],"sourceRoot":"/source/"}